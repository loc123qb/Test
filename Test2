local Rayfield = loadstring(game:HttpGet("https://raw.githubusercontent.com/Puhcoder16/theme/refs/heads/main/theme"))()
    local Window = Rayfield:CreateWindow({
   Name = "Loc dep trai",
   Icon = 0, -- Icon in Topbar. Can use Lucide Icons (string) or Roblox Image (number). 0 to use no icon (default).
   LoadingTitle = "Ez",
   LoadingSubtitle = "by Locc",
   ShowText = "Rayfield", -- for mobile users to unhide rayfield, change if you'd like
   Theme = "Default", -- Check https://docs.sirius.menu/rayfield/configuration/themes

   ToggleUIKeybind = "M", -- The keybind to toggle the UI visibility (string like "K" or Enum.KeyCode)

   DisableRayfieldPrompts = false,
   DisableBuildWarnings = false, -- Prevents Rayfield from warning when the script has a version mismatch with the interface

   ConfigurationSaving = {
   Enabled = true,
   FolderName = "Loccdz", -- ðŸ‘ˆ pháº£i Ä‘á»ƒ trong dáº¥u ngoáº·c kÃ©p
   FileName = "Locc Hub"
},

        
   Discord = {
      Enabled = false, -- Prompt the user to join your Discord server if their executor supports it
      Invite = "noinvitelink", -- The Discord invite code, do not include discord.gg/. E.g. discord.gg/ ABCD would be ABCD
      RememberJoins = true -- Set this to false to make them join the discord every time they load it up
   },

   KeySystem = false, -- Set this to true to use our key system
   KeySettings = {
      Title = "Untitled",
      Subtitle = "Key System",
      Note = "No method of obtaining the key is provided", -- Use this to tell the user how to get a key
      FileName = "Key", -- It is recommended to use something unique as other scripts using Rayfield may overwrite your key file
      SaveKey = true, -- The user's key will be saved, but if you change the key, they will be unable to use your script
      GrabKeyFromSite = false, -- If this is true, set Key below to the RAW site you would like Rayfield to get the key from
      Key = {"Hello"} -- List of keys that will be accepted by the system, can be RAW file links (pastebin, github etc) or simple strings ("hello","key22")
   }
})

local Tab = Window:CreateTab("Home", nil) -- Title, Image
local MainSection = Tab:CreateSection("Main")
local MiscTab = Window:CreateTab("Misc", nil) -- Title, Image

-- Biáº¿n toÃ n cá»¥c Ä‘iá»u khiá»ƒn
_G.AutoSkill = false

-- Táº¡o toggle Auto Skill
local Toggle = Tab:CreateToggle({
    Name = "Auto Skill Chain Lightning",
    CurrentValue = false,
    Flag = "Toggle1",
    Callback = function(Value)
        _G.AutoSkill = Value
        if Value then
            print("ÄÃ£ báº­t Auto Skill")
            AutoSkillFunc()
        else
            print("ÄÃ£ táº¯t Auto Skill")
        end
    end,
})

-- Auto Skill: Chain Lightning (chá» combo hoÃ n táº¥t trÆ°á»›c khi báº¯t Ä‘áº§u)
function AutoSkillFunc()
    task.spawn(function()
        -- Náº¿u biáº¿n _G.ComboDone chÆ°a Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a (khÃ´ng dÃ¹ng combo), máº·c Ä‘á»‹nh cho true
        if _G.ComboDone == nil then _G.ComboDone = true end

        -- Chá» combo hoÃ n táº¥t trÆ°á»›c khi báº¯t Ä‘áº§u (náº¿u combo Ä‘ang cháº¡y)
        repeat task.wait() until _G.ComboDone == true

        -- Báº¯t Ä‘áº§u loop sá»­ dá»¥ng skill khi _G.AutoSkill = true
        while _G.AutoSkill do
            task.wait(0)
            local ok, err = pcall(function()
                local args = { [1] = "EBD5165C-DB2C-4A41-A43C-7EC83AEB89E9" }
                local player = game:GetService("Players").LocalPlayer
                local skill = (player and player:FindFirstChild("Backpack") and player.Backpack:FindFirstChild("Chain Lightning")) 
                              or (player.Character and player.Character:FindFirstChild("Chain Lightning"))
                if skill and skill:FindFirstChild("abilityEvent") then
                    skill.abilityEvent:FireServer(unpack(args))
                end
            end)
            if not ok then
                warn("[AutoSkill] pcall error:", err)
                task.wait(0.5)
            end
        end
    end)
end


-- Biáº¿n Ä‘iá»u khiá»ƒn AutoLift
_G.Autolift = false
local running = false

-- Auto Heal: Chain Heal (chá» combo hoÃ n táº¥t trÆ°á»›c khi báº¯t Ä‘áº§u)
local function AutoLiftFunc()
    if running then return end -- trÃ¡nh cháº¡y trÃ¹ng
    running = true
    task.spawn(function()
        -- Náº¿u biáº¿n _G.ComboDone chÆ°a Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a (khÃ´ng dÃ¹ng combo), máº·c Ä‘á»‹nh cho true
        if _G.ComboDone == nil then _G.ComboDone = true end

        -- Chá» combo hoÃ n táº¥t trÆ°á»›c khi báº¯t Ä‘áº§u (náº¿u combo Ä‘ang cháº¡y)
        repeat task.wait() until _G.ComboDone == true

        while _G.Autolift do
            task.wait(0)
            local ok, err = pcall(function()
                local args = { [1] = "852E0487-29F7-4293-AD32-9F02DD884A51" }
                local player = game:GetService("Players").LocalPlayer
                local skill = (player and player:FindFirstChild("Backpack") and player.Backpack:FindFirstChild("Chain Heal"))
                              or (player.Character and player.Character:FindFirstChild("Chain Heal"))
                if skill and skill:FindFirstChild("spellEvent") then
                    skill.spellEvent:FireServer(unpack(args))
                end
            end)
            if not ok then
                warn("[AutoHeal] pcall error:", err)
                task.wait(0.5)
            end
        end

        running = false
    end)
end


-- Táº¡o Toggle trÃªn GUI
local Toggle = Tab:CreateToggle({
    Name = "Auto Heal (Chain Heal)",
    CurrentValue = false,      -- máº·c Ä‘á»‹nh táº¯t
    Flag = "Toggle_AutoHeal",  -- Flag duy nháº¥t Ä‘á»ƒ lÆ°u
    Callback = function(Value)
        _G.Autolift = Value
        if Value then
            print("âœ… Auto Heal ÄÃƒ Báº¬T")
            AutoLiftFunc()
        else
            print("â›” Auto Heal ÄÃƒ Táº®T")
        end
    end,
})


--// âš¡ Auto Overcharge (theo phong cÃ¡ch Auto Heal)
_G.AutoOvercharge = false
local running = false

-- HÃ m chÃ­nh
local function AutoOverchargeFunc()
    if running then return end -- trÃ¡nh cháº¡y trÃ¹ng
    running = true
    task.spawn(function()
        -- Náº¿u cÃ³ combo thÃ¬ chá» hoÃ n táº¥t trÆ°á»›c khi kÃ­ch hoáº¡t
        if _G.ComboDone == nil then _G.ComboDone = true end
        repeat task.wait() until _G.ComboDone == true

        while _G.AutoOvercharge do
            task.wait(0)
            local ok, err = pcall(function()
                local args = { [1] = "17314bb0-099c-461b-afb9-01ddcad548bd" }
                local player = game:GetService("Players").LocalPlayer
                local skill = (player and player:FindFirstChild("Backpack") and player.Backpack:FindFirstChild("Overcharge"))
                            or (player.Character and player.Character:FindFirstChild("Overcharge"))
                if skill and skill:FindFirstChild("abilityEvent") then
                    skill.abilityEvent:FireServer(unpack(args))
                end
            end)
            if not ok then
                warn("[AutoOvercharge] pcall error:", err)
                task.wait(0.5)
            end
        end

        running = false
    end)
end

--// ðŸ§© Toggle trÃªn GUI
local Toggle = Tab:CreateToggle({
    Name = "Auto Overcharge",
    CurrentValue = false,          -- máº·c Ä‘á»‹nh táº¯t
    Flag = "Toggle_AutoOvercharge", -- Flag duy nháº¥t Ä‘á»ƒ lÆ°u
    Callback = function(Value)
        _G.AutoOvercharge = Value
        if Value then
            print("âœ… Auto Overcharge ÄÃƒ Báº¬T")
            AutoOverchargeFunc()
        else
            print("â›” Auto Overcharge ÄÃƒ Táº®T")
        end
    end,
})


-- ========= Auto Combo (1 láº§n) + Toggle (lÆ°u config) =========
-- ChÃ¨n sau Auto Heal toggle, trÆ°á»›c Auto Farm

-- Ä‘áº£m báº£o biáº¿n toÃ n cá»¥c tá»“n táº¡i
_G.ComboDone = _G.ComboDone or true
_G.ComboRunning = _G.ComboRunning or false

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer

-- an toÃ n: swap set
local function swapSet(setName)
    local args = {
        [1] = {
            [1] = { ["\3"] = "swapAbilitySet" },
            [2] = setName
        }
    }
    if ReplicatedStorage:FindFirstChild("dataRemoteEvent") and type(ReplicatedStorage.dataRemoteEvent.FireServer) == "function" then
        pcall(function()
            ReplicatedStorage.dataRemoteEvent:FireServer(unpack(args))
        end)
    end
end

-- an toÃ n: dÃ¹ng skill (tÃ¬m trong Backpack hoáº·c Character)
local function useSkill(skillName, skillID)
    if not player then return false end

    local function findInst(name)
        if player:FindFirstChild("Backpack") then
            local s = player.Backpack:FindFirstChild(name)
            if s then return s end
        end
        if player.Character then
            local s2 = player.Character:FindFirstChild(name)
            if s2 then return s2 end
        end
        -- fallback: tÃ¬m theo descendants (náº¿u tÃªn náº±m sÃ¢u)
        if player:FindFirstChild("Backpack") then
            for _,v in ipairs(player.Backpack:GetDescendants()) do
                if v.Name == name then return v end
            end
        end
        if player.Character then
            for _,v in ipairs(player.Character:GetDescendants()) do
                if v.Name == name then return v end
            end
        end
        return nil
    end

    local inst = findInst(skillName)
    if not inst then return false end

    local ev = inst:FindFirstChild("abilityEvent") or inst:FindFirstChild("spellEvent")
    if ev and type(ev.FireServer) == "function" then
        pcall(function() ev:FireServer(skillID) end)
        return true
    end

    -- náº¿u instance báº£n thÃ¢n cÃ³ FireServer (hiáº¿m)
    if type(inst.FireServer) == "function" then
        pcall(function() inst:FireServer(skillID) end)
        return true
    end

    return false
end

-- cháº¡y combo 1 láº§n, Ä‘áº·t _G.ComboDone = true chá»‰ khi hoÃ n táº¥t tháº­t sá»±
local function RunComboOnce()
    if _G.ComboRunning then return end
    _G.ComboRunning = true
    _G.ComboDone = false -- khoÃ¡ cÃ¡c script khÃ¡c

    task.spawn(function()
        local setM, setN = "M", "N"

        -- 1) Ä‘á»•i sang M
        swapSet(setM)
        task.wait(0.4) -- Ä‘á»£i swap server sync

        -- 2) dÃ¹ng Inner Focus
        local ok1 = useSkill("Inner Focus", "6D6A8BC4-B85F-4A20-B626-8AF8EF44DB9D")
        if not ok1 then warn("[AutoCombo] KhÃ´ng tÃ¬m tháº¥y hoáº·c khÃ´ng thá»ƒ dÃ¹ng Inner Focus") end

        -- 3) chá» 1s -> dÃ¹ng Innervate
        task.wait(1)
        local ok2 = useSkill("Innervate", "87C934DD-13DE-4DD2-A8BC-B3DA8C470515")
        if not ok2 then warn("[AutoCombo] KhÃ´ng tÃ¬m tháº¥y hoáº·c khÃ´ng thá»ƒ dÃ¹ng Innervate") end

        -- 4) chá» 1s -> swap set M 1 láº§n ná»¯a
        task.wait(1)
        swapSet(setM)
        task.wait(0.5)

        -- 5) swap vá» set N (ban Ä‘áº§u)
        swapSet(setN)
        task.wait(0.2)

        -- hoÃ n táº¥t
        _G.ComboDone = true
        _G.ComboRunning = false

        if Rayfield and type(Rayfield.Notify) == "function" then
            pcall(function()
                Rayfield:Notify({
                    Title = "Auto Combo",
                    Content = "Combo hoÃ n táº¥t â€” scripts khÃ¡c sáº½ báº¯t Ä‘áº§u.",
                    Duration = 3
                })
            end)
        else
            print("[AutoCombo] Combo hoÃ n táº¥t")
        end
    end)
end

-- Toggle (lÆ°u config báº±ng Flag)
local AutoComboToggle = Tab:CreateToggle({
    Name = "Auto Combo 1 Láº§n (Save Config)",
    CurrentValue = false,
    Flag = "AutoComboOnce",
    Callback = function(Value)
        if Value then
            -- khi báº­t toggle: cháº¡y 1 láº§n
            RunComboOnce()
        end
    end,
})

-- Khi load script náº¿u Flag Ä‘Ã£ báº­t (Ä‘Æ°á»£c lÆ°u) -> tá»± cháº¡y 1 láº§n
task.defer(function()
    task.wait(1)
    if Rayfield and Rayfield.Flags and Rayfield.Flags.AutoComboOnce and Rayfield.Flags.AutoComboOnce.CurrentValue == true then
        -- náº¿u combo chÆ°a cháº¡y thÃ¬ cháº¡y 1 láº§n
        if not _G.ComboRunning and _G.ComboDone ~= true then
            RunComboOnce()
        elseif not _G.ComboRunning and _G.ComboDone == true then
            -- náº¿u ComboDone Ä‘Ã£ true (khÃ´ng cáº§n cháº¡y), Ä‘áº£m báº£o combo tráº¡ng thÃ¡i OK
        else
            -- Ä‘ang cháº¡y, Ä‘á»£i xong
        end
    end
end)
-- ========= END =========


--// âš”ï¸ Dungeon Quest - Auto Farm Behind NPC + Auto Dodge (Smooth & Safe - FIXED)
local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")

-- âš™ï¸ Cáº¥u hÃ¬nh
local tweenSpeed = 14
local hoverHeight = 0
local maxRange = 4000
_G.AutoTween = false
_G.AutoDodge = true
_G.AutoRedZoneDodge = true

local dodgeDistance = 8
local dodgeCooldown = 0.8
local dodgeDetectRange = 25
local orbitRadius = 12
local orbitDuration = 3.5
local backOffset = 8
local groundRayLength = 120

-- ðŸ§  Láº¥y Humanoid & Root
local function getHumanoidAndRoot(model)
	if not model then return end
	local hum = model:FindFirstChildOfClass("Humanoid")
	local root = model:FindFirstChild("HumanoidRootPart") or model:FindFirstChild("Torso")
	return hum, root
end

-- ðŸ§© Bá» qua ngÆ°á»i chÆ¡i
local function isPlayerModel(model)
	for _, player in ipairs(Players:GetPlayers()) do
		if player.Character == model then
			return true
		end
	end
	return false
end

-- ðŸ” TÃ¬m NPC xa nháº¥t
local function getFarthestNPC()
	local char = LocalPlayer.Character
	if not char then return end
	local _, root = getHumanoidAndRoot(char)
	if not root then return end

	local farthest, longest = nil, 0
	for _, v in ipairs(Workspace:GetDescendants()) do
		if v:IsA("Model") and v ~= char then
			local hum, hrp = getHumanoidAndRoot(v)
			if hum and hrp and hum.Health > 0 and not isPlayerModel(v) then
				local dist = (hrp.Position - root.Position).Magnitude
				if dist > longest and dist < maxRange then
					longest = dist
					farthest = v
				end
			end
		end
	end
	return farthest
end

-- ðŸŒ Láº¥y tá»a Ä‘á»™ sÃ¡t máº·t Ä‘áº¥t
local function getGroundY(pos)
	local ray = Ray.new(pos + Vector3.new(0, 5, 0), Vector3.new(0, -groundRayLength, 0))
	local hit, hitPos = Workspace:FindPartOnRay(ray)
	if hit then
		return hitPos.Y
	end
	return pos.Y
end

-- ðŸŒ€ Di chuyá»ƒn quanh phÃ­a sau NPC (mÆ°á»£t + an toÃ n)
local function tweenTo(target)
	local char = LocalPlayer.Character
	if not char then return end
	local hum, root = getHumanoidAndRoot(char)
	if not root or not target then return end

	local _, targetRoot = getHumanoidAndRoot(target)
	if not targetRoot then return end

	local npcLook = targetRoot.CFrame.LookVector
	local center = targetRoot.Position
	local backPos = center - npcLook * backOffset

	local targetY = getGroundY(backPos)
	local targetPos = Vector3.new(backPos.X, targetY + hoverHeight, backPos.Z)

	local tweenInfo = TweenInfo.new(0.6, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut)
	local tween = TweenService:Create(root, tweenInfo, { CFrame = CFrame.new(targetPos, center) })
	tween:Play()
	tween.Completed:Wait()
end

-- âš¡ NÃ© váº­t thá»ƒ táº¥n cÃ´ng (Projectile)
local lastDodge = 0
local isDodging = false
local function autoDodge()
	if not _G.AutoDodge or isDodging then return end
	if tick() - lastDodge < dodgeCooldown then return end

	local char = LocalPlayer.Character
	if not char then return end
	local _, root = getHumanoidAndRoot(char)
	if not root then return end

	for _, v in ipairs(Workspace:GetDescendants()) do
		if v:IsA("BasePart") and v.Parent and not isPlayerModel(v.Parent) then
			local n = v.Name:lower()
			if n:find("attack") or n:find("projectile") or n:find("hit") then
				local dist = (v.Position - root.Position).Magnitude
				if dist < dodgeDetectRange then
					isDodging = true
					lastDodge = tick()

					local side = math.random(0, 1) == 0 and -1 or 1
					local dodgeDir = root.CFrame.RightVector * side * dodgeDistance
					local newPos = root.Position + dodgeDir

					local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Sine, Enum.EasingDirection.Out)
					local tween = TweenService:Create(root, tweenInfo, { CFrame = CFrame.new(newPos) })
					tween:Play()
					tween.Completed:Connect(function()
						isDodging = false
					end)
					break
				end
			end
		end
	end
end

-- âš ï¸ NÃ© vÃ¹ng Ä‘á» (AOE) - Ra sau quÃ¡i + tiáº¿p tá»¥c farm
local activeZoneDodge = false
local detectedZones = {}

local function isRedColor(color)
	return (color.R > 0.4 and color.G < 0.3 and color.B < 0.3)
end

local function isDangerZone(part)
	if not part:IsA("BasePart") then return false end
	local n = part.Name:lower()
	if n:find("aoe") or n:find("warning") or n:find("indicator") then return true end
	if isRedColor(part.Color) and part.Transparency < 0.7 then return true end
	return false
end

local function moveBehindNPC()
	if activeZoneDodge then return end
	activeZoneDodge = true

	local char = LocalPlayer.Character
	if not char then activeZoneDodge = false return end
	local hum, root = getHumanoidAndRoot(char)
	if not root then activeZoneDodge = false return end

	local npc = getFarthestNPC()
	if not npc then activeZoneDodge = false return end
	local _, npcRoot = getHumanoidAndRoot(npc)
	if not npcRoot then activeZoneDodge = false return end

	local backPos = npcRoot.Position - npcRoot.CFrame.LookVector * (backOffset + 10)
	local safeY = getGroundY(backPos)
	local safePos = Vector3.new(backPos.X, safeY + hoverHeight, backPos.Z)

	local tweenInfo = TweenInfo.new(0.5, Enum.EasingStyle.Sine, Enum.EasingDirection.Out)
	local tween = TweenService:Create(root, tweenInfo, { CFrame = CFrame.new(safePos, npcRoot.Position) })
	tween:Play()
	tween.Completed:Wait()

	task.wait(1.8) -- ðŸ•’ Äá»©ng yÃªn 1.8s rá»“i quay láº¡i tiáº¿p tá»¥c farm
	activeZoneDodge = false
end

Workspace.DescendantAdded:Connect(function(obj)
	if isDangerZone(obj) and not detectedZones[obj] then
		detectedZones[obj] = true
		task.defer(function()
			if not _G.AutoRedZoneDodge then return end
			local char = LocalPlayer.Character
			if not char then return end
			local _, root = getHumanoidAndRoot(char)
			if not root then return end

			local dist = (root.Position - obj.Position).Magnitude
			local size = obj.Size
			if dist < (math.max(size.X, size.Z) / 2) + 5 then
				moveBehindNPC()
			end
		end)
	end
end)

-- ðŸ” Auto Farm Loop
task.spawn(function()
	while task.wait(0.3) do
		if _G.AutoTween and not activeZoneDodge then
			autoDodge()
			local npc = getFarthestNPC()
			if npc then
				tweenTo(npc)
			end
		end
	end
end)







local Toggle = MiscTab:CreateToggle({
	Name = "Auto Start",
	CurrentValue = false,
	Flag = "Toggle_AutoStart",
	Callback = function(Value)
		_G.AutoStart = Value

		if _G.AutoStart then
			warn("âœ… Auto Start ÄÃƒ Báº¬T")

			-- ðŸ” Cháº¡y liÃªn tá»¥c cho Ä‘áº¿n khi táº¯t
			task.spawn(function()
            repeat task.wait() until _G.ComboDone == true

				while _G.AutoStart do
					-- âš¡ Gá»­i lá»‡nh start
					game:GetService("ReplicatedStorage").remotes.changeStartValue:FireServer()
					warn("ðŸ” Auto Start Ä‘ang thá»±c thi...")

					-- â± Chá» 1â€“2 giÃ¢y Ä‘á»ƒ trÃ¡nh spam server
					task.wait(2)
				end
				warn("â›” Auto Start ÄÃƒ Dá»ªNG")
			end)

		else
			warn("â›” Auto Start ÄÃƒ Táº®T THá»¦ CÃ”NG")
		end
	end,
})


local Toggle = MiscTab:CreateToggle({
	Name = "Auto Retry",
	CurrentValue = false,
	Flag = "Toggle_AutoRetry",
	Callback = function(Value)
		_G.AutoRetry = Value

		if _G.AutoRetry then
			warn("âœ… Auto Retry ÄÃƒ Báº¬T")

			-- ðŸ” Cháº¡y liÃªn tá»¥c cho Ä‘áº¿n khi táº¯t
			task.spawn(function()
				while _G.AutoRetry do
					-- âš¡ Gá»­i lá»‡nh retry
					local args = {
                        [1] = {
                            [1] = {
                                ["\3"] = "vote",
                                ["vote"] = true
                            },
                            [2] = "-"
                        }
                    }

                    game:GetService("ReplicatedStorage").dataRemoteEvent:FireServer(unpack(args))
					warn("ðŸ” Auto Retry Ä‘ang thá»±c thi...")

					-- â± Chá» 1â€“2 giÃ¢y Ä‘á»ƒ trÃ¡nh spam server
					task.wait(2)
				end
				warn("â›” Auto Retry ÄÃƒ Dá»ªNG")
			end)

		else
			warn("â›” Auto Retry ÄÃƒ Táº®T THá»¦ CÃ”NG")
		end
	end,
})

---- âš™ï¸ FIX LAG (TÃ­ch há»£p vÃ o Misc Tab)
local Players = game:GetService("Players")
local Lighting = game:GetService("Lighting")
local Workspace = game:GetService("Workspace")
local LocalPlayer = Players.LocalPlayer

local active = false
local saved = {}

-- ðŸŒˆ LÆ°u cáº¥u hÃ¬nh Ã¡nh sÃ¡ng gá»‘c
local function saveOriginal()
    saved.Lighting = {
        Technology = Lighting.Technology,
        GlobalShadows = Lighting.GlobalShadows,
        Brightness = Lighting.Brightness,
        FogEnd = Lighting.FogEnd
    }
end

-- ðŸ”„ KhÃ´i phá»¥c cáº¥u hÃ¬nh Ã¡nh sÃ¡ng gá»‘c
local function restoreOriginal()
    if not saved.Lighting then return end
    Lighting.Technology = saved.Lighting.Technology
    Lighting.GlobalShadows = saved.Lighting.GlobalShadows
    Lighting.Brightness = saved.Lighting.Brightness
    Lighting.FogEnd = saved.Lighting.FogEnd
end

-- ðŸ’¨ HÃ m giáº£m hiá»‡u á»©ng tá»«ng Ä‘á»‘i tÆ°á»£ng
local function minimize(obj)
    if obj:IsA("ParticleEmitter") or obj:IsA("Beam") or obj:IsA("Trail") or obj:IsA("Smoke") or obj:IsA("Fire") or obj:IsA("Sparkles") then
        obj.Enabled = false
    end

    if obj:IsA("Explosion") then
        obj.Visible = false
    end

    if obj:IsA("BasePart") then
        obj.Material = Enum.Material.SmoothPlastic
        obj.Reflectance = 0
        obj.CastShadow = false
        obj.Color = Color3.fromRGB(200,200,200)
    end

    if obj:IsA("Decal") or obj:IsA("Texture") then
        obj.Transparency = 1
    end

    if obj:IsA("Sound") then
        obj.Volume = 0
        obj:Stop()
    end

    if obj:IsA("Light") then
        obj.Enabled = false
    end
end

-- ðŸš€ Ãp dá»¥ng cháº¿ Ä‘á»™ giáº£m lag
local function applyLiteMode()
    Lighting.Technology = Enum.Technology.Compatibility
    Lighting.GlobalShadows = false
    Lighting.Brightness = 1
    Lighting.FogEnd = 999999999

    for _, obj in ipairs(Workspace:GetDescendants()) do
        minimize(obj)
    end

    Workspace.DescendantAdded:Connect(function(obj)
        if active then minimize(obj) end
    end)
end

-- ðŸ§© Báº­t/Táº¯t FixLag
local function toggleFixLag(on)
    active = on
    if on then
        saveOriginal()
        applyLiteMode()
        warn("âœ… Fix Lag LITE: ON")
    else
        restoreOriginal()
        warn("â›” Fix Lag LITE: OFF (báº¡n cÃ³ thá»ƒ cáº§n rejoin Ä‘á»ƒ khÃ´i phá»¥c hoÃ n toÃ n)")
    end
end

-- ðŸŽ›ï¸ ThÃªm Toggle vÃ o Misc Tab
local ToggleFixLag = MiscTab:CreateToggle({
    Name = "Fix Lag (Lite Mode)",
    CurrentValue = false,
    Flag = "Toggle_FixLag",
    Callback = function(Value)
        toggleFixLag(Value)
    end,
})





local WalkspeedInput = MiscTab:CreateInput({
    Name = "Walkspeed Input",
    PlaceholderText = "Nháº­p tá»‘c Ä‘á»™ (VD: 100)",
    CurrentValue = "16",
    RemoveTextAfterFocusLost = false,
    Flag = "Walkspeed_Input",

    Callback = function(Text)
        local Speed = tonumber(Text)
        if not Speed then
            warn("âŒ HÃ£y nháº­p sá»‘ há»£p lá»‡!")
            return
        end

        Speed = math.clamp(Speed, 0, 300)

        local player = game.Players.LocalPlayer
        local humanoid = player and player.Character and player.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = Speed
            warn("âœ… Äáº·t tá»‘c Ä‘á»™ thÃ nh:", Speed)
        end
    end,
})

-- ðŸ§  ThÃªm sá»± kiá»‡n auto-clear khi click vÃ o textbox
task.spawn(function()
    task.wait(1) -- Ä‘á»£i UI load xong
    local box = WalkspeedInput.InputBox or WalkspeedInput.TextBox or WalkspeedInput

    if box and box.FocusGained then
        box.FocusGained:Connect(function()
            box.Text = "" -- xoÃ¡ ná»™i dung hiá»‡n táº¡i khi click vÃ o
        end)
    else
        warn("âš ï¸ KhÃ´ng tÃ¬m tháº¥y TextBox (cÃ³ thá»ƒ UI lib cá»§a báº¡n dÃ¹ng tÃªn khÃ¡c)")
    end
end)

-- ðŸ§  Tá»± Ä‘á»™ng khÃ´i phá»¥c láº¡i tráº¡ng thÃ¡i Toggle/Input khi má»Ÿ láº¡i game
task.spawn(function()
    task.wait(1) -- Ä‘á»£i UI load hoÃ n táº¥t
    Rayfield.LoadConfiguration() -- khÃ´i phá»¥c má»i giÃ¡ trá»‹ Ä‘Ã£ lÆ°u
end)
